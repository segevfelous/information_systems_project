<!-- ---------- order_preview.html (FULL UPDATED per your rules) ---------- -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>order Preview</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <style>
    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      background:#F6F8FC;
      color:#0E1D2D;
    }

    .page{
      width:100%;
      max-width:none;
      padding:40px 32px;
    }

    .card{
      width:100%;
      max-width: 980px;
      margin: 0 auto;
      background:#fff;
      border-radius:22px;
      padding:26px;
      box-shadow:0 14px 36px rgba(14,29,45,0.12);
      border:1px solid #E6EBF3;
    }

    h1{ margin:0 0 10px; font-size:28px; }
    h2{ margin:18px 0 10px; font-size:20px; }

    .muted{
      color:#546275;
      font-size:14px;
      margin: 0 0 10px;
    }

    .meta{
      background: rgba(201,182,255,.12);
      border: 1px solid rgba(201,182,255,.45);
      border-radius: 16px;
      padding: 14px;
      margin-top: 14px;
    }

    .meta p{ margin: 6px 0; font-size:14px; }

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:12px;
      font-size:14px;
    }

    th{
      background:#F1F4FA;
      text-align:left;
      padding:10px;
      border-bottom:2px solid #E6EBF3;
      white-space:nowrap;
    }

    td{
      padding:10px;
      border-bottom:1px solid #E6EBF3;
      vertical-align:top;
    }

    tr:hover{ background:#FAFBFE; }

    .total{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      background:#0E1D2D;
      color:#fff;
      border-radius:18px;
      padding:14px 16px;
      margin-top: 12px;
    }

    .total strong{ font-size:18px; }

    .warning{
      background: rgba(201,182,255,.22);
      border: 1px solid rgba(201,182,255,.6);
      color:#0E1D2D;
      padding:10px 12px;
      border-radius:14px;
      margin: 10px 0 12px;
      font-weight:bold;
      font-size:14px;
    }

    label{
      display:block;
      font-weight:bold;
      font-size:14px;
      margin:10px 0 6px;
    }

    input{
      width:100%;
      max-width:420px;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid #E6EBF3;
      font-size:14px;
      box-sizing:border-box;
    }

    input:focus{
      outline:none;
      border-color:#6F5BFF;
      box-shadow:0 0 0 3px rgba(201,182,255,0.5);
    }

    .actions{
      margin-top:16px;
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
    }

    .btn{
      padding:12px 14px;
      border-radius:14px;
      font-weight:bold;
      cursor:pointer;
      border:1px solid transparent;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:14px;
    }

    .btn-primary{ background:#4A7A87; color:white; }
    .btn-primary:hover{ background:#2E4D5C; }

    .btn-ghost{
      background:white;
      color:#0E1D2D;
      border-color:#E6EBF3;
    }
    .btn-ghost:hover{ background:rgba(201,182,255,.18); }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      max-width: 900px;
    }

    @media(max-width:700px){
      .grid{ grid-template-columns: 1fr; }
      .card{ padding:20px; }
    }
    .grid .full{ grid-column: 1 / -1; }

    #phones-container{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:8px;
      margin-bottom:12px;
    }

    .phone-row{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    .phone-input{
      width:100%;
      max-width:420px;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid #E6EBF3;
      font-size:14px;
      box-sizing:border-box;
    }

    .remove-phone-btn{
      padding:10px 12px;
      border-radius:12px;
      border:1px solid #E6EBF3;
      background:white;
      font-weight:bold;
      cursor:pointer;
      color: black;
    }
    .remove-phone-btn:hover{ background:rgba(201,182,255,.18); }

    .add-phone-btn{
      max-width:420px;
      padding:12px 14px;
      border-radius:14px;
      border:1px dashed rgba(201,182,255,.7);
      background:white;
      color:#0E1D2D;
      font-weight:bold;
      cursor:pointer;
    }
    .add-phone-btn:hover{ background:rgba(201,182,255,.18); }
  </style>
</head>

<body>
<div class="page">
  <div class="card">

    <h1>Order Preview</h1>

    <div class="meta">
      <p><b>order code:</b> {{ order_code }}</p>
      <p><b>Email:</b> {{ email }}</p>
      <p><b>Flight:</b> {{ flight_date }} {{ departure_time }} | {{ flight.Departure_Airport }} â†’ {{ flight.Destination_Airport }}</p>
    </div>

    <h2>Selected seats</h2>
    <table>
      <thead>
        <tr>
          <th>Seat</th>
          <th>Class</th>
          <th>Price</th>
        </tr>
      </thead>
      <tbody>
      {% for s in seat_items %}
        <tr>
          <td>{{ s.seat }}</td>
          <td>{{ s.class }}</td>
          <td>{{ s.price }}$</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>

    <h2>Total</h2>
    <div class="total">
      <div>Total to pay</div>
      <strong>{{ total_price }}$</strong>
    </div>

    <form method="POST" action="/order/confirm">
      <h2>Passenger details</h2>
      <div class="warning">All fields are required</div>

      <div class="grid">
        <div>
          <label>First name</label>
          <input name="fname" placeholder="First name" required value="{{ customer_fname or '' }}">
        </div>

        <div>
          <label>Last name</label>
          <input name="lname" placeholder="Last name" required value="{{ customer_lname or '' }}">
        </div>

        <div>
          <label>Passport number</label>
          <input name="passport_number" placeholder="Passport number" required value="{{ customer_passport_number or '' }}">
        </div>

        <div>
          <label>Date of birth</label>
          <input type="date" name="date_of_birth" required value="{{ customer_date_of_birth or '' }}">
        </div>

        <div class="full">
          <label>Phone Numbers</label>

          <div id="phones-container">
            {% for p in phones %}
              <div class="phone-row">
                <input
                  type="text"
                  name="phone"
                  placeholder="Phone number (Required)"
                  class="phone-input"
                  value="{{ p }}"
                  {% if loop.first %}required{% endif %}
                />
                {% if not loop.first %}
                  <button type="button" class="remove-phone-btn" onclick="this.parentElement.remove();">Remove</button>
                {% endif %}
              </div>
            {% endfor %}
          </div>

          <button type="button" id="add-phone-btn" class="add-phone-btn">
            + Add another phone
          </button>
        </div>
      </div>

      <div class="actions">
        <button class="btn btn-primary" type="submit">Confirm order</button>
        <a class="btn btn-ghost" href="/session/clear">Cancel</a>
      </div>
    </form>

  </div>
</div>

<script>
  (function () {
    const container = document.getElementById("phones-container");
    const addBtn = document.getElementById("add-phone-btn");
    if (!container || !addBtn) return;

    addBtn.addEventListener("click", function () {
      const row = document.createElement("div");
      row.className = "phone-row";

      const input = document.createElement("input");
      input.type = "text";
      input.name = "phone";
      input.placeholder = "Phone number (Required)";
      input.className = "phone-input";

      const removeBtn = document.createElement("button");
      removeBtn.type = "button";
      removeBtn.className = "remove-phone-btn";
      removeBtn.textContent = "Remove";
      removeBtn.addEventListener("click", function () {
        row.remove();
      });

      row.appendChild(input);
      row.appendChild(removeBtn);
      container.appendChild(row);
    });
  })();
</script>

</body>
</html>

